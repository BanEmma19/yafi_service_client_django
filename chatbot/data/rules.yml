version: "3.1"

rules:
- rule: Répondre à une salutation
  steps:
  - intent: salutation
  - action: utter_salutation

- rule: Répondre à une demande de passage de commande
  steps:
  - intent: passer_commande
  - action: utter_passer_commande

- rule: Répondre à une demande sur les modes de paiement
  steps:
  - intent: mode_paiement
  - action: utter_mode_paiement

- rule: Répondre à une demande de suivi de commande
  steps:
  - intent: suivi_commande
  - action: utter_suivi_commande

- rule: Répondre à une question sur le délai de livraison
  steps:
  - intent: délai_livraison
  - action: utter_délai_livraison

- rule: Répondre à un problème de paiement
  steps:
  - intent: problème_paiement
  - action: utter_problème_paiement

- rule: Répondre à une demande d'annulation de commande
  steps:
  - intent: annulation_commande
  - action: utter_annulation_commande

- rule: Répondre à une demande de contact avec un livreur
  steps:
  - intent: contacter_livreur
  - action: utter_contacter_livreur

- rule: Répondre à une question sur les horaires de service
  steps:
  - intent: disponibilité_service
  - action: utter_disponibilité_service

- rule: Répondre à une demande pour devenir partenaire
  steps:
  - intent: devenir_partenaire
  - action: utter_devenir_partenaire

- rule: Activation du formulaire pour une commande en mauvais état
  steps:
  - intent: commande_mauvais_etat
  - action: commande_mauvais_etat_form
  - active_loop: commande_mauvais_etat_form

- rule: Confirmation du signalement d'une commande en mauvais état
  condition:
  - active_loop: commande_mauvais_etat_form
  steps:
  - action: commande_mauvais_etat_form
  - active_loop: null
  - action: utter_confirm_signalement

- rule: Activation du formulaire pour une double facturation
  steps:
  - intent: double_facturation
  - action: double_facturation_form
  - active_loop: double_facturation_form

- rule: Confirmation du signalement d'une double facturation
  condition:
  - active_loop: double_facturation_form
  steps:
  - action: double_facturation_form
  - active_loop: null
  - action: utter_confirm_double_facturation

- rule: Démarrage formulaire
  steps:
  - intent: compte_suspendu
  - action: compte_suspendu_form
  - active_loop: compte_suspendu_form

- rule: Validation réussie
  condition:
  - active_loop: compte_suspendu_form
  - slot_was_set:
    - email_utilisateur: true
  steps:
  - action: utter_confirmation
  - action: action_listen  # Désactive implicitement le formulaire

- rule: Email invalide
  condition:
  - active_loop: compte_suspendu_form
  - slot_was_set:
    - email_utilisateur: null
  steps:
  - action: utter_email_invalide
  - action: compte_suspendu_form
  - active_loop: compte_suspendu_form

- rule: Activation du formulaire pour une commande non livree
  steps:
  - intent: commande_non_livree
  - action: commande_non_livree_form
  - active_loop: commande_non_livree_form

- rule: Confirmation d'une commande non livree
  condition:
  - active_loop: commande_non_livree_form
  steps:
  - action: commande_non_livree_form
  - active_loop: null
  - action: utter_confirm_commande_non_livree

- rule: Activation du formulaire pour un remboursement
  steps:
  - intent: remboursement
  - action: remboursement_form
  - active_loop: remboursement_form

- rule: Confirmation d'une demande de remboursement
  condition:
  - active_loop:  remboursement_form
  steps:
  - action: remboursement_form
  - active_loop: null
  - action: utter_confirm_remboursement
